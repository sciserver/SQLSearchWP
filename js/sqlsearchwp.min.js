!function(s){"use strict";var t={context:"#sqls-container",levels:["info","warning","danger"],whichs:["test","prod"],wheres:{skyserverws:"http://skyserver.sdss.org/dr14/en/tools/search/x_results.aspx?searchtool=SQL&TaskName=Skyserver.Search.SQL&ReturnHtml=true&format=html&cmd="},query:{test:"SELECT TOP 10 p.objid,p.ra,p.dec,p.u,p.g,p.r,p.i,p.z, p.run, p.rerun, p.camcol, p.field, s.specobjid, s.class, s.z as redshift, s.plate, s.mjd, s.fiberid FROM PhotoObj AS p JOIN SpecObj AS s ON s.bestobjid = p.objid WHERE p.u BETWEEN 0 AND 19.6 AND g BETWEEN 0 AND 20",prod:""},init:function(){var e=s(t.context).data("sqls-webroot");s(t.context).data("sqls-which");this.showMessages("Welcome","Please enjoy this form.","info",!1),this.showInstructions(e+"includes/"),this.showForm(t.context),this.showResults("",!1),s(t.context).on("submit","form#sqls-form",function(s){s.preventDefault()}),s(t.context).on("click","#sqls-submit",t.doSubmit),s(t.context).on("click","#sqls-syntax",t.doSyntax),s(t.context).on("click","#sqls-reset",t.doReset)},doSubmit:function(e){var o,n=s(t.context).data("sqls-where"),r=t.wheres[n]+encodeURI(s("#sqls-query").val())+"&syntax=NoSyntax";(o=new XMLHttpRequest).onreadystatechange=function(){if(4===this.readyState&&200===this.status){var s=this.responseText;t.showResults(s,!1)}},o.open("GET",r,!0),o.send()},doSyntax:function(e){var o,n=s(t.context).data("sqls-where"),r=t.wheres[n]+encodeURI(s("#sqls-query").val())+"&syntax=Syntax";(o=new XMLHttpRequest).onreadystatechange=function(){if(4===this.readyState&&200===this.status){var s=this.responseText;t.showResults(s,!1)}},o.open("GET",r,!0),o.send()},doReset:function(s){console.log("reset form"),t.showForm(t.context),t.showResults("",!1)},showMessages:function(e,o,n,r){var i=s(".sqls-messages")[0],a=s(".sqls-messages-wrap")[0],l=void 0!==r&&r?s(i).html():"",c=void 0!==n&&t.levels.indexOf(n)>=0?"alert-"+n:"alert-primary";l+=void 0!==e?'<h3 class="sqls-msg-title '+c+' ">'+e+"</h3>":"",l='<div class="'+c+' sqls-msg">'+(l+=void 0!==o?'<div class="sqls-msg-body '+c+' ">'+o+"</div>":"")+"</div>",s(i).html(l),s(a).show(),0===s(i).html().length&&s(a).hide()},showInstructions:function(t){var e,o=s(".sqls-instructions")[0];s(".sqls-instructions-wrap")[0];(e=new XMLHttpRequest).onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=this.responseText;s(o).html(t)}},e.open("GET",t+"instructions-test.txt",!0),e.send()},showForm:function(e){s(".sqls-form")[0],s(".sqls-form-wrap")[0];var o=t.query[s(e).data("sqls-which")];s("#sqls-query").prop("value",o)},showResults:function(t,e){var o=s(".sqls-results")[0],n=(s(".sqls-results-wrap")[0],void 0!==e&&e?s(o).html():"");n+=void 0!==t?'<div class="sqls-results">'+t+"</div>":"",s(o).html(n)}};s(document).ready(function(){1===s("#sqls-container").length?t.init():console.log('Error running sqlsearchwp.js. Only one "#sqls-container" expected.')})}(jQuery);